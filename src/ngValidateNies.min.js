"use strict";angular.module("ngValidateNIEs",[]).factory("$vatEsValidators",function(){return{validNIE:function(a){var t=/^[XYZxyz]\d{7,8}[A-Za-z]$/;if(a.match(t)){var e=a.charAt(0);switch(e){case"X":e=0;break;case"x":e=0;break;case"Y":e=1;break;case"y":e=1;break;case"Z":e=2;break;case"z":e=2}return e+a.substr(1)}return!1},validCIF:function(a){a=a.toUpperCase();var t=/^[ABEH]\d{8}$/i,e=/^[KPQS][0-9]{7}[A-J]$/i,r=/^[CDFGJLMNRUVW][0-9]{7}[0-9A-J]$/i;if(a.match(t)||a.match(e)||a.match(r)){for(var i=a[a.length-1],s=0,n=0,l=1;8>l;l++)if(l%2===0)s+=parseInt(a[l]);else{var d=2*parseInt(a[l]),v=0;v=d>9?1+(d-10):d,n+=v}var c=parseInt(s+n)+"",u=(10-parseInt(c[c.length-1]))%10,o="JABCDEFGHI";return i>="0"&&"9">=i?i==u:i.toUpperCase()===o[u]}return!1},validDNI:function(a){var t=/^\d{8}[a-zA-Z]$/;if(!t.test(a))return!1;var e="TRWAGMYFPDXBNJZSQVHLCKET",r=a.substr(0,a.length-1),i=a.substr(a.length-1,1).toUpperCase();return e.charAt(r%23)===i?!0:void 0}}}).directive("validateNiEs",["$vatEsValidators",function(a){return{restric:"A",require:"ngModel",link:function(t,e,r,i){function s(t){return a.validCIF(t)?i.$setValidity("validateNiEs",!0):a.validDNI(t)?i.$setValidity("validateNiEs",!0):a.validNIE(t)&&a.validDNI(a.validNIE(t))?i.$setValidity("validateNiEs",!0):i.$setValidity("validateNiEs",!1),t}i.$parsers.unshift(s)}}}]);